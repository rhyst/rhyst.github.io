!function(){"use strict";var e="undefined"==typeof global?self:global;if("function"!=typeof e.require){var t={},n={},o={},r={}.hasOwnProperty,i=/^\.\.?(\/|$)/,s=function(e,t){for(var n,o=[],r=(i.test(t)?e+"/"+t:t).split("/"),s=0,a=r.length;s<a;s++)n=r[s],".."===n?o.pop():"."!==n&&""!==n&&o.push(n);return o.join("/")},a=function(e){return e.split("/").slice(0,-1).join("/")},c=function(t){return function(n){var o=s(a(t),n);return e.require(o,t)}},l=function(e,t){var o=y&&y.createHot(e),r={id:e,exports:{},hot:o};return n[e]=r,t(r.exports,c(e),r),r.exports},u=function(e){return o[e]?u(o[e]):e},d=function(e,t){return u(s(a(e),t))},p=function(e,o){null==o&&(o="/");var i=u(e);if(r.call(n,i))return n[i].exports;if(r.call(t,i))return l(i,t[i]);throw new Error("Cannot find module '"+e+"' from '"+o+"'")};p.alias=function(e,t){o[t]=e};var f=/\.[^.\/]+$/,h=/\/index(\.[^\/]+)?$/,m=function(e){if(f.test(e)){var t=e.replace(f,"");r.call(o,t)&&o[t].replace(f,"")!==t+"/index"||(o[t]=e)}if(h.test(e)){var n=e.replace(h,"");r.call(o,n)||(o[n]=e)}};p.register=p.define=function(e,o){if(e&&"object"==typeof e)for(var i in e)r.call(e,i)&&p.register(i,e[i]);else t[e]=o,delete n[e],m(e)},p.list=function(){var e=[];for(var n in t)r.call(t,n)&&e.push(n);return e};var y=e._hmr&&new e._hmr(d,p,t,n);p._cache=n,p.hmr=y&&y.wrap,p.brunch=!0,e.require=p}}(),function(){var e=("undefined"==typeof window?this:window,function(e,t,n){var o={},r=function(t,n){var i;try{return i=e(n+"/node_modules/"+t)}catch(s){if(s.toString().indexOf("Cannot find module")===-1)throw s;if(n.indexOf("node_modules")!==-1){var a=n.split("/"),c=a.lastIndexOf("node_modules"),l=a.slice(0,c).join("/");return r(t,l)}}return o};return function(i){if(i in t&&(i=t[i]),i){if("."!==i[0]&&n){var s=r(i,n);if(s!==o)return s}return e(i)}}});require.register("preact/dist/preact.js",function(t,n,o){n=e(n,{},"preact"),function(){!function(){"use strict";function e(){}function t(t,n){var o,r,i,s,a=T;for(s=arguments.length;s-- >2;)P.push(arguments[s]);for(n&&null!=n.children&&(P.length||P.push(n.children),delete n.children);P.length;)if((r=P.pop())&&void 0!==r.pop)for(s=r.length;s--;)P.push(r[s]);else"boolean"==typeof r&&(r=null),(i="function"!=typeof t)&&(null==r?r="":"number"==typeof r?r=String(r):"string"!=typeof r&&(i=!1)),i&&o?a[a.length-1]+=r:a===T?a=[r]:a.push(r),o=i;var c=new e;return c.nodeName=t,c.children=a,c.attributes=null==n?void 0:n,c.key=null==n?void 0:n.key,void 0!==O.vnode&&O.vnode(c),c}function n(e,t){for(var n in t)e[n]=t[n];return e}function r(e,o){return t(e.nodeName,n(n({},e.attributes),o),arguments.length>2?[].slice.call(arguments,2):e.children)}function i(e){!e.__d&&(e.__d=!0)&&1==q.push(e)&&(O.debounceRendering||F)(s)}function s(){var e,t=q;for(q=[];e=t.pop();)e.__d&&S(e)}function a(e,t,n){return"string"==typeof t||"number"==typeof t?void 0!==e.splitText:"string"==typeof t.nodeName?!e._componentConstructor&&c(e,t.nodeName):n||e._componentConstructor===t.nodeName}function c(e,t){return e.__n===t||e.nodeName.toLowerCase()===t.toLowerCase()}function l(e){var t=n({},e.attributes);t.children=e.children;var o=e.nodeName.defaultProps;if(void 0!==o)for(var r in o)void 0===t[r]&&(t[r]=o[r]);return t}function u(e,t){var n=t?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e);return n.__n=e,n}function d(e){var t=e.parentNode;t&&t.removeChild(e)}function p(e,t,n,o,r){if("className"===t&&(t="class"),"key"===t);else if("ref"===t)n&&n(null),o&&o(e);else if("class"!==t||r)if("style"===t){if(o&&"string"!=typeof o&&"string"!=typeof n||(e.style.cssText=o||""),o&&"object"==typeof o){if("string"!=typeof n)for(var i in n)i in o||(e.style[i]="");for(var i in o)e.style[i]="number"==typeof o[i]&&!1===L.test(i)?o[i]+"px":o[i]}}else if("dangerouslySetInnerHTML"===t)o&&(e.innerHTML=o.__html||"");else if("o"==t[0]&&"n"==t[1]){var s=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),o?n||e.addEventListener(t,h,s):e.removeEventListener(t,h,s),(e.__l||(e.__l={}))[t]=o}else if("list"!==t&&"type"!==t&&!r&&t in e)f(e,t,null==o?"":o),null!=o&&!1!==o||e.removeAttribute(t);else{var a=r&&t!==(t=t.replace(/^xlink\:?/,""));null==o||!1===o?a?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):"function"!=typeof o&&(a?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),o):e.setAttribute(t,o))}else e.className=o||""}function f(e,t,n){try{e[t]=n}catch(o){}}function h(e){return this.__l[e.type](O.event&&O.event(e)||e)}function m(){for(var e;e=B.pop();)O.afterMount&&O.afterMount(e),e.componentDidMount&&e.componentDidMount()}function y(e,t,n,o,r,i){I++||(R=null!=r&&void 0!==r.ownerSVGElement,A=null!=e&&!("__preactattr_"in e));var s=v(e,t,n,o,i);return r&&s.parentNode!==r&&r.appendChild(s),--I||(A=!1,i||m()),s}function v(e,t,n,o,r){var i=e,s=R;if(null!=t&&"boolean"!=typeof t||(t=""),"string"==typeof t||"number"==typeof t)return e&&void 0!==e.splitText&&e.parentNode&&(!e._component||r)?e.nodeValue!=t&&(e.nodeValue=t):(i=document.createTextNode(t),e&&(e.parentNode&&e.parentNode.replaceChild(i,e),_(e,!0))),i.__preactattr_=!0,i;var a=t.nodeName;if("function"==typeof a)return k(e,t,n,o);if(R="svg"===a||"foreignObject"!==a&&R,a=String(a),(!e||!c(e,a))&&(i=u(a,R),e)){for(;e.firstChild;)i.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(i,e),_(e,!0)}var l=i.firstChild,d=i.__preactattr_,p=t.children;if(null==d){d=i.__preactattr_={};for(var f=i.attributes,h=f.length;h--;)d[f[h].name]=f[h].value}return!A&&p&&1===p.length&&"string"==typeof p[0]&&null!=l&&void 0!==l.splitText&&null==l.nextSibling?l.nodeValue!=p[0]&&(l.nodeValue=p[0]):(p&&p.length||null!=l)&&g(i,p,n,o,A||null!=d.dangerouslySetInnerHTML),b(i,t.attributes,d),R=s,i}function g(e,t,n,o,r){var i,s,c,l,u,p=e.childNodes,f=[],h={},m=0,y=0,g=p.length,x=0,b=t?t.length:0;if(0!==g)for(var w=0;w<g;w++){var C=p[w],M=C.__preactattr_,j=b&&M?C._component?C._component.__k:M.key:null;null!=j?(m++,h[j]=C):(M||(void 0!==C.splitText?!r||C.nodeValue.trim():r))&&(f[x++]=C)}if(0!==b)for(var w=0;w<b;w++){l=t[w],u=null;var j=l.key;if(null!=j)m&&void 0!==h[j]&&(u=h[j],h[j]=void 0,m--);else if(!u&&y<x)for(i=y;i<x;i++)if(void 0!==f[i]&&a(s=f[i],l,r)){u=s,f[i]=void 0,i===x-1&&x--,i===y&&y++;break}u=v(u,l,n,o),c=p[w],u&&u!==e&&u!==c&&(null==c?e.appendChild(u):u===c.nextSibling?d(c):e.insertBefore(u,c))}if(m)for(var w in h)void 0!==h[w]&&_(h[w],!1);for(;y<=x;)void 0!==(u=f[x--])&&_(u,!1)}function _(e,t){var n=e._component;n?E(n):(null!=e.__preactattr_&&e.__preactattr_.ref&&e.__preactattr_.ref(null),!1!==t&&null!=e.__preactattr_||d(e),x(e))}function x(e){for(e=e.lastChild;e;){var t=e.previousSibling;_(e,!0),e=t}}function b(e,t,n){var o;for(o in n)t&&null!=t[o]||null==n[o]||p(e,o,n[o],n[o]=void 0,R);for(o in t)"children"===o||"innerHTML"===o||o in n&&t[o]===("value"===o||"checked"===o?e[o]:n[o])||p(e,o,n[o],n[o]=t[o],R)}function w(e){var t=e.constructor.name;(V[t]||(V[t]=[])).push(e)}function C(e,t,n){var o,r=V[e.name];if(e.prototype&&e.prototype.render?(o=new e(t,n),z.call(o,t,n)):(o=new z(t,n),o.constructor=e,o.render=M),r)for(var i=r.length;i--;)if(r[i].constructor===e){o.__b=r[i].__b,r.splice(i,1);break}return o}function M(e,t,n){return this.constructor(e,n)}function j(e,t,n,o,r){e.__x||(e.__x=!0,(e.__r=t.ref)&&delete t.ref,(e.__k=t.key)&&delete t.key,!e.base||r?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,o),o&&o!==e.context&&(e.__c||(e.__c=e.context),e.context=o),e.__p||(e.__p=e.props),e.props=t,e.__x=!1,0!==n&&(1!==n&&!1===O.syncComponentUpdates&&e.base?i(e):S(e,1,r)),e.__r&&e.__r(e))}function S(e,t,o,r){if(!e.__x){var i,s,a,c=e.props,u=e.state,d=e.context,p=e.__p||c,f=e.__s||u,h=e.__c||d,v=e.base,g=e.__b,x=v||g,b=e._component,w=!1;if(v&&(e.props=p,e.state=f,e.context=h,2!==t&&e.shouldComponentUpdate&&!1===e.shouldComponentUpdate(c,u,d)?w=!0:e.componentWillUpdate&&e.componentWillUpdate(c,u,d),e.props=c,e.state=u,e.context=d),e.__p=e.__s=e.__c=e.__b=null,e.__d=!1,!w){i=e.render(c,u,d),e.getChildContext&&(d=n(n({},d),e.getChildContext()));var M,k,z=i&&i.nodeName;if("function"==typeof z){var N=l(i);s=b,s&&s.constructor===z&&N.key==s.__k?j(s,N,1,d,!1):(M=s,e._component=s=C(z,N,d),s.__b=s.__b||g,s.__u=e,j(s,N,0,d,!1),S(s,1,o,!0)),k=s.base}else a=x,M=b,M&&(a=e._component=null),(x||1===t)&&(a&&(a._component=null),k=y(a,i,d,o||!v,x&&x.parentNode,!0));if(x&&k!==x&&s!==b){var P=x.parentNode;P&&k!==P&&(P.replaceChild(k,x),M||(x._component=null,_(x,!1)))}if(M&&E(M),e.base=k,k&&!r){for(var T=e,F=e;F=F.__u;)(T=F).base=k;k._component=T,k._componentConstructor=T.constructor}}if(!v||o?B.unshift(e):w||(e.componentDidUpdate&&e.componentDidUpdate(p,f,h),O.afterUpdate&&O.afterUpdate(e)),null!=e.__h)for(;e.__h.length;)e.__h.pop().call(e);I||r||m()}}function k(e,t,n,o){for(var r=e&&e._component,i=r,s=e,a=r&&e._componentConstructor===t.nodeName,c=a,u=l(t);r&&!c&&(r=r.__u);)c=r.constructor===t.nodeName;return r&&c&&(!o||r._component)?(j(r,u,3,n,o),e=r.base):(i&&!a&&(E(i),e=s=null),r=C(t.nodeName,u,n),e&&!r.__b&&(r.__b=e,s=null),j(r,u,1,n,o),e=r.base,s&&e!==s&&(s._component=null,_(s,!1))),e}function E(e){O.beforeUnmount&&O.beforeUnmount(e);var t=e.base;e.__x=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var n=e._component;n?E(n):t&&(t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),e.__b=t,d(t),w(e),x(t)),e.__r&&e.__r(null)}function z(e,t){this.__d=!0,this.context=t,this.props=e,this.state=this.state||{}}function N(e,t,n){return y(n,e,{},!1,t,!1)}var O={},P=[],T=[],F="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout,L=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,q=[],B=[],I=0,R=!1,A=!1,V={};n(z.prototype,{setState:function(e,t){var o=this.state;this.__s||(this.__s=n({},o)),n(o,"function"==typeof e?e(o,this.props):e),t&&(this.__h=this.__h||[]).push(t),i(this)},forceUpdate:function(e){e&&(this.__h=this.__h||[]).push(e),S(this,2)},render:function(){}});var W={h:t,createElement:t,cloneElement:r,Component:z,render:N,rerender:s,options:O};"undefined"!=typeof o?o.exports=W:self.preact=W}()}()}),require.register("js/shared/config.js",function(e,t,n){"use strict";var o=10,r=40,i=10,s=25,a=8,c=2e-5,l=1,u=50,d=25e3,p=1e4,f=1,h=i/o*f;n.exports={metre:o,numOfNodes:r,nominalStringLength:i,springConstant:s,internalViscousFrictionConstant:a,viscousConstant:c,simulationSpeed:l,maxStep:u,dangerForceMax:d,dangerForceMin:p,ropeWeightPerMetre:f,ropeWeightPerNode:h}}),require.register("js/shared/constants.js",function(e,t,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.ControlsEnum=Object.freeze({pan:"pan",grab:"grab",anchor:"anchor",erase:"erase",rope:"rope"})}),require.register("js/shared/helper.js",function(e,t,n){"use strict";function o(e,t){return t.find(function(t){return t.id===e})}function r(e,t){var n=Math.abs(e.position.x-t.position.x),o=Math.abs(e.position.y-t.position.y);return Math.sqrt(n*n+o*o)}function i(e,t){return{x:(e.position.x+t.position.x)/2,y:(e.position.y+t.position.y)/2}}function s(e,t){return Math.atan2(t.position.y-e.position.y,t.position.x-e.position.x)}function a(e,t){var n=r(e,t),o=n-c.nominalStringLength,i=s(e,t),a=Math.sin(i)*o*c.springConstant,l=Math.cos(i)*o*c.springConstant,u=Math.sqrt(a*a+(l+l));return{total:u,x:l,y:a}}var c=t("js/shared/config");n.exports={getAngleFromHorizontal:s,getForce:a,getLength:r,getMidpoint:i,getNode:o}}),require.register("js/shared/node.js",function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(){return s+=1}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=-1,a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,l=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[],d=arguments[8];o(this,e),this.id=d?d:r(),this.position=new Vector(t,n),this.velocity=new Vector(i,s),this.force=new Vector(a,c),this.fixed=l,this.connectedNodes=u}return i(e,[{key:"getObject",value:function(){return{id:this.id,position:this.position,velocity:this.velocity,force:this.force,fixed:this.fixed,connectedNodes:this.connectedNodes}}},{key:"loadObject",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.id=e.id?e.id:this.id,this.position=e.position||this.position,this.velocity=e.velocity||this.velocity,this.force=e.force||this.force,this.fixed=e.fixed||this.fixed,this.connectedNodes=e.connectedNodes||this.connectedNodes}},{key:"copyNode",value:function(){return new e(this.position.x,this.position.y,this.velocity.x,this.velocity.y,this.force.x,this.force.y,this.fixed,this.connectedNodes,this.id)}}]),e}();n.exports={Node:a}}),require.register("js/shared/vector.js",function(e,t,n){"use strict";function o(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0}o.prototype={load:function(e){return new o(e.x||0,e.y||0,e.z||0)},negative:function(){return new o((-this.x),(-this.y),(-this.z))},add:function(e){return e instanceof o?new o(this.x+e.x,this.y+e.y,this.z+e.z):new o(this.x+e,this.y+e,this.z+e)},subtract:function(e){return e instanceof o?new o(this.x-e.x,this.y-e.y,this.z-e.z):new o(this.x-e,this.y-e,this.z-e)},multiply:function(e){return e instanceof o?new o(this.x*e.x,this.y*e.y,this.z*e.z):new o(this.x*e,this.y*e,this.z*e)},divide:function(e){return e instanceof o?new o(this.x/e.x,this.y/e.y,this.z/e.z):new o(this.x/e,this.y/e,this.z/e)},equals:function(e){return this.x==e.x&&this.y==e.y&&this.z==e.z},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},cross:function(e){return new o(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)},length:function(){return Math.sqrt(this.dot(this))},unit:function(){return this.divide(this.length())},min:function(){return Math.min(Math.min(this.x,this.y),this.z)},max:function(){return Math.max(Math.max(this.x,this.y),this.z)},toAngles:function(){return{theta:Math.atan2(this.z,this.x),phi:Math.asin(this.y/this.length())}},angleTo:function(e){return Math.acos(this.dot(e)/(this.length()*e.length()))},toArray:function(e){return[this.x,this.y,this.z].slice(0,e||3)},clone:function(){return new o(this.x,this.y,this.z)},init:function(e,t,n){return this.x=e,this.y=t,this.z=n,this}},o.negative=function(e,t){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t},o.add=function(e,t,n){return n=n?n:new o,t instanceof o?(n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z):(n.x=e.x+t,n.y=e.y+t,n.z=e.z+t),n},o.subtract=function(e,t,n){return n=n?n:new o,t instanceof o?(n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z):(n.x=e.x-t,n.y=e.y-t,n.z=e.z-t),n},o.multiply=function(e,t,n){return n=n?n:new o,t instanceof o?(n.x=e.x*t.x,n.y=e.y*t.y,n.z=e.z*t.z):(n.x=e.x*t,n.y=e.y*t,n.z=e.z*t),n},o.divide=function(e,t,n){return t instanceof o?(n.x=e.x/t.x,n.y=e.y/t.y,n.z=e.z/t.z):(n.x=e.x/t,n.y=e.y/t,n.z=e.z/t),n},o.cross=function(e,t,n){return n.x=e.y*t.z-e.z*t.y,n.y=e.z*t.x-e.x*t.z,n.z=e.x*t.y-e.y*t.x,n},o.unit=function(e,t){var n=e.length();return t.x=e.x/n,t.y=e.y/n,t.z=e.z/n,t},o.fromAngles=function(e,t){return new o(Math.cos(e)*Math.cos(t),Math.sin(t),Math.sin(e)*Math.cos(t))},o.randomDirection=function(){return o.fromAngles(Math.random()*Math.PI*2,Math.asin(2*Math.random()-1))},o.min=function(e,t){return new o(Math.min(e.x,t.x),Math.min(e.y,t.y),Math.min(e.z,t.z))},o.max=function(e,t){return new o(Math.max(e.x,t.x),Math.max(e.y,t.y),Math.max(e.z,t.z))},o.lerp=function(e,t,n){return t.subtract(e).multiply(n).add(e)},o.fromArray=function(e){return new o(e[0],e[1],e[2])},o.angleBetween=function(e,t){return e.angleTo(t)},n.exports={Vector:o}}),require.register("js/initialise.js",function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var r=t("preact"),i=t("./ui/components/App"),s=o(i);document.addEventListener("DOMContentLoaded",function(){(0,r.render)((0,r.h)(s["default"],null),document.querySelector("#app"))})}),require.register("js/ui/components/App.js",function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=t("preact"),l=t("js/ui/components/canvas/canvas"),u=o(l),d=t("js/ui/components/controls/controls"),p=o(d),f=t("js/ui/components/stats/stats"),h=o(f),m=t("js/shared/constants.js"),y=function(e){function t(e){r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.onFrame=function(){n.state.worker.postMessage("send"),requestAnimationFrame(n.onFrame)},n.handleWorker=function(e){n.setState({nodes:e.data.nodes,trueSimulationSpeed:e.data.trueSimulationSpeed})},n.changeControl=function(e){n.setState({selectedControl:e})},n.changeScale=function(e){var t=n.state.scale;!e&&t<=1||e&&t<1?(e?t+=.1:t-=.1,t=Math.round(10*t)/10):e?t+=1:t-=1,t<=0||n.setState({scale:t})};var o=new Worker("worker.js");return o.onmessage=n.handleWorker,o.postMessage("init"),n.state={worker:o,nodes:[],selectedControl:m.ControlsEnum.pan,scale:1},n}return s(t,e),a(t,[{key:"componentDidMount",value:function(){requestAnimationFrame(this.onFrame),this.state.worker.postMessage("run")}},{key:"render",value:function(){return(0,c.h)("main",null,(0,c.h)(u["default"],{nodes:this.state.nodes,worker:this.state.worker,selectedControl:this.state.selectedControl,scale:this.state.scale}),(0,c.h)(p["default"],{selectedControl:this.state.selectedControl,changeControl:this.changeControl,changeScale:this.changeScale,scale:this.state.scale}),(0,c.h)(h["default"],{trueSimulationSpeed:this.state.trueSimulationSpeed}))}}]),t}(c.Component);e["default"]=y}),require.register("js/ui/components/canvas/canvas.js",function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=t("preact"),l=t("js/shared/config"),u=o(l),d=t("js/shared/helper"),p=o(d),f=t("js/shared/vector"),h=t("js/shared/constants.js"),m=function(e){function t(e){r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.interact=function(){var e=n.canvas;n.props.nodes,n.canvas.getContext("2d");e.addEventListener("mousedown",function(t){var o=e.getBoundingClientRect(),r={x:t.clientX-o.left,y:t.clientY-o.top},i=(new f.Vector).load(n.state.transformed),s=new f.Vector(r.x,r.y),a=s.subtract(i).divide(n.props.scale);if(n.props.selectedControl===h.ControlsEnum.grab){for(var c,l=n.props.nodes,u=20,d=0;d<l.length;d++){l[d].position=(new f.Vector).load(l[d].position);var p=l[d].position.subtract(s.subtract(i).divide(n.props.scale)).length();(!u||p<u)&&(c=l[d],u=p)}n.setState({mousePosition:a}),c&&n.setState({selectedNode:c})}else if(n.props.selectedControl===h.ControlsEnum.pan)n.setState({startCoords:{x:t.pageX-o.left-n.state.lastCoords.x,y:t.pageY-o.top-n.state.lastCoords.y}});else if(n.props.selectedControl===h.ControlsEnum.anchor)n.props.worker.postMessage(["newanchor",{mousePosition:a}]);else if(n.props.selectedControl===h.ControlsEnum.erase){for(var l=n.props.nodes,u=5,d=0;d<l.length;d++){l[d].position=(new f.Vector).load(l[d].position);var p=l[d].position.subtract(s.subtract(i).divide(n.props.scale)).length();p<u&&n.props.worker.postMessage(["deletenode",{node:l[d]}])}n.setState({mousePosition:s.subtract(i)})}n.setState({mousedown:!0})},!0),e.addEventListener("mousemove",function(t){var o=e.getBoundingClientRect(),r={x:t.clientX-o.left,y:t.clientY-o.top},i=(new f.Vector).load(n.state.transformed),s=new f.Vector(r.x,r.y).subtract(i).divide(n.props.scale);if(n.setState({mousePosition:s}),n.props.selectedControl===h.ControlsEnum.grab)n.setState({mousePosition:s});else if(n.props.selectedControl===h.ControlsEnum.pan)n.state.mousedown&&n.setState({transformed:{x:r.x-n.state.startCoords.x,y:r.y-n.state.startCoords.y}});else if(n.props.selectedControl===h.ControlsEnum.erase&&n.state.mousedown)for(var a=n.props.nodes,c=5,l=0;l<a.length;l++){a[l].position=(new f.Vector).load(a[l].position);var u=a[l].position.subtract(s).length();u<c&&n.props.worker.postMessage(["deletenode",{node:a[l]}])}},!0),e.addEventListener("mouseup",function(t){if(n.props.selectedControl===h.ControlsEnum.grab)n.state.selectedNode&&n.props.worker.postMessage(["nomove",{selectedNode:n.state.selectedNode}]),n.setState({selectedNode:null});else if(n.props.selectedControl===h.ControlsEnum.pan){var o=e.getBoundingClientRect();n.setState({lastCoords:{x:t.pageX-o.left-n.state.startCoords.x,y:t.pageY-o.top-n.state.startCoords.y},startCoords:null})}n.setState({mousedown:!1})},!0),window.addEventListener("scroll",function(e){console.log(window.scrollY)}),document.onkeypress=function(e){e=e||window.event,console.log(e.keyCode)}},n.draw=function(){function e(e,n){if(o.beginPath(),o.fillRect(e.position.x-1,e.position.y-1,3,3),t&&o.fillText(e.id,e.position.x+1,e.position.y),o.stroke(),i.indexOf(n.toString()+e.id.toString())<0){o.beginPath();var s=p.getNode(n,r);o.moveTo(s.position.x,s.position.y),o.lineTo(e.position.x,e.position.y),i.push(e.id.toString()+s.id.toString());var a=p.getForce(e,s);a.total>=u.dangerForceMin&&a.total<u.dangerForceMax?(normForce=(a.total-u.dangerForceMin)/(u.dangerForceMax-u.dangerForceMin),color=255*normForce,o.strokeStyle="rgb("+color.toFixed(0)+", 0, 0)"):a.total>=u.dangerForceMax?o.strokeStyle="rgb(255, 0, 0)":o.strokeStyle="rgb(0,0,0)",o.stroke()}}var t=!0,o=n.canvas.getContext("2d"),r=n.props.nodes;o.strokeStyle="rgb(0,0,0)",o.save(),o.setTransform(1,0,0,1,0,0),o.clearRect(0,0,n.canvas.width,n.canvas.height),o.restore(),o.setTransform(n.props.scale,0,0,n.props.scale,n.state.transformed.x,n.state.transformed.y),n.props.selectedControl===h.ControlsEnum.erase&&(o.beginPath(),o.arc(n.state.mousePosition.x,n.state.mousePosition.y,5,0,2*Math.PI),o.stroke()),o.beginPath(),o.moveTo(10,50),o.lineTo(10,50+10*u.metre),o.fillText("10m",11,50+10*u.metre/2),o.stroke();var i=[];r.forEach(function(n){n.connectedNodes.length<=0&&(o.beginPath(),o.fillRect(n.position.x-1,n.position.y-1,3,3),t&&o.fillText(n.id,n.position.x+1,n.position.y),o.stroke()),n.connectedNodes.forEach(e.bind(this,n))})},n.state={mousedown:!1,selectedNode:null,mousePosition:{x:0,y:0},startCoords:{x:0,y:0},lastCoords:{x:0,y:0},transformed:{x:0,y:0}},n}return s(t,e),a(t,[{key:"componentDidMount",value:function(){this.interact()}},{key:"componentDidUpdate",value:function(){this.draw(),this.state.selectedNode&&this.props.worker.postMessage(["move",{selectedNode:this.state.selectedNode,mousePosition:this.state.mousePosition}])}},{key:"render",value:function(){var e=this;return(0,c.h)("canvas",{ref:function(t){return e.canvas=t},id:"canvas",width:window.innerWidth,height:window.innerHeight})}}]),t}(c.Component);e["default"]=m}),require.register("js/ui/components/controls/controls.js",function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=t("preact"),c=t("js/shared/constants.js"),l=function(e){function t(e){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return i(t,e),s(t,[{key:"render",value:function(){var e=this;return(0,a.h)("div",{"class":"controls buttons has-addons"},(0,a.h)("button",{"class":"button is-small "+(this.props.selectedControl==c.ControlsEnum.pan&&"is-active"),onClick:function(){e.props.changeControl(c.ControlsEnum.pan)}},(0,a.h)("span",{"class":"icon"},(0,a.h)("i",{"class":"far fa-hand-paper"}))),(0,a.h)("button",{"class":"button is-small "+(this.props.selectedControl==c.ControlsEnum.grab&&"is-active"),onClick:function(){e.props.changeControl(c.ControlsEnum.grab)}},(0,a.h)("span",{"class":"icon"},(0,a.h)("i",{"class":"far fa-hand-rock"}))),(0,a.h)("button",{"class":"button is-small "+(this.props.selectedControl==c.ControlsEnum.anchor&&"is-active"),onClick:function(){e.props.changeControl(c.ControlsEnum.anchor)}},(0,a.h)("span",{"class":"icon"},(0,a.h)("i",{"class":"fas fa-plus"}))),(0,a.h)("button",{"class":"button is-small "+(this.props.selectedControl==c.ControlsEnum.rope&&"is-active"),onClick:function(){e.props.changeControl(c.ControlsEnum.rope)}},(0,a.h)("span",{"class":"icon"},(0,a.h)("i",{"class":"fas fa-pencil-alt"}))),(0,a.h)("button",{"class":"button is-small "+(this.props.selectedControl==c.ControlsEnum.erase&&"is-active"),onClick:function(){e.props.changeControl(c.ControlsEnum.erase)}},(0,a.h)("span",{"class":"icon"},(0,a.h)("i",{"class":"fas fa-eraser"}))),(0,a.h)("button",{"class":"button is-small",onClick:function(){e.props.changeScale(!1)}},(0,a.h)("span",{"class":"icon"},"-")),(0,a.h)("button",{"class":"button is-small",disabled:!0},this.props.scale),(0,a.h)("button",{"class":"button is-small",onClick:function(){e.props.changeScale(!0)}},(0,a.h)("span",{"class":"icon"},"+")))}}]),t}(a.Component);e["default"]=l}),require.register("js/ui/components/stats/stats.js",function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=t("preact"),l=t("js/shared/config"),u=o(l),d=function(e){function t(e){r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={simSpeeds:new Array(100).fill(u.simulationSpeed),calculatedSimSpeed:u.simulationSpeed},n}return s(t,e),a(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.state.simSpeeds;t.pop(),t.unshift(e.trueSimulationSpeed);var n=t.reduce(function(e,t){return e+t},0);this.setState({simSpeeds:t,calculatedSimSpeed:n/t.length})}},{key:"render",value:function(){return(0,c.h)("div",{"class":"stats"},(0,c.h)("span",null,this.state.calculatedSimSpeed.toFixed(2),"x"))}}]),t}(c.Component);e["default"]=d}),require.register("js/ui/front.js",function(e,t,n){"use strict";var o=t("js/shared/helper"),r=t("js/shared/config"),i=t("js/shared/vector").Vector;document.addEventListener("DOMContentLoaded",function(){function e(){_.pop(),_.unshift(u);var e=_.reduce(function(e,t){return e+t},0);document.getElementById("simspeed").innerText=(e/_.length).toFixed(2)+"x"}function t(){function e(e,n){if(c.beginPath(),c.fillRect(e.position.x-1,e.position.y-1,3,3),f&&c.fillText(e.id,e.position.x+1,e.position.y),c.stroke(),t.indexOf(n.toString()+e.id.toString())<0){c.beginPath();var i=o.getNode(n,l);c.moveTo(i.position.x,i.position.y),c.lineTo(e.position.x,e.position.y),t.push(e.id.toString()+i.id.toString());var s=o.getForce(e,i);s.total>=r.dangerForceMin&&s.total<r.dangerForceMax?(normForce=(s.total-r.dangerForceMin)/(r.dangerForceMax-r.dangerForceMin),color=255*normForce,c.strokeStyle="rgb("+color.toFixed(0)+", 0, 0)"):s.total>=r.dangerForceMax?c.strokeStyle="rgb(255, 0, 0)":c.strokeStyle="rgb(0,0,0)",c.stroke()}}c.strokeStyle="rgb(0,0,0)",c.clearRect(0-g.x,0-g.y,a.width,a.height),c.strokeStyle="rgb(0,0,0)",c.beginPath(),c.moveTo(10,50),c.lineTo(10,50+10*r.metre),c.fillText("10m",11,50+10*r.metre/2),c.stroke();var t=[];l.forEach(function(t){t.connectedNodes.length<=0&&(c.beginPath(),c.fillRect(t.position.x-1,t.position.y-1,3,3),f&&c.fillText(t.id,t.position.x+1,t.position.y),c.stroke()),t.connectedNodes.forEach(e.bind(this,t))})}function n(){function e(e,n){if(parseInt(document.getElementById("to").value)===n){t=!0;var r=o.getNode(n,l),i=o.getForce(e,r);document.getElementById("result").innerText=i.total.toFixed(3)+"N"}}var t=!1;l.forEach(function(t){parseInt(document.getElementById("from").value)===t.id&&t.connectedNodes.forEach(e.bind(this,t))}),t||(document.getElementById("result").innerText="Not connected")}function s(e){h&&d.postMessage(["move",{selectedNode:h,mousePosition:m}]),d.postMessage("send"),requestAnimationFrame(s)}var a=document.getElementById("canvas"),c=a.getContext("2d"),l=[],u=0,d=new Worker("worker.js");d.onmessage=function(o){l=o.data.nodes,u=o.data.trueSimulationSpeed,t(),n(),e()},d.postMessage("init"),document.getElementById("start").addEventListener("click",function(){p=!1,d.postMessage("run")});var p=!1;document.getElementById("stop").addEventListener("click",function(){p=!0,d.postMessage("pause")});var f=!0;document.getElementById("show-ids").addEventListener("click",function(){f=document.getElementById("show-ids").checked}),document.getElementById("load").addEventListener("click",function(){var e=document.getElementById("load-data").value;
d.postMessage(["load",e])}),document.getElementById("save").addEventListener("click",function(){document.getElementById("save-data").value=btoa(JSON.stringify(l))});var h,m,y,v={x:0,y:0},g={x:0,y:0};a.addEventListener("mousedown",function(e){for(var t,n=a.getBoundingClientRect(),o={x:e.clientX-n.left,y:e.clientY-n.top},r=new i(o.x,o.y),s=(new i).load(g),c=5,u=0;u<l.length;u++){l[u].position=(new i).load(l[u].position);var d=l[u].position.subtract(r.subtract(s)).length();(!c||d<c)&&(t=l[u],c=d)}m=r.subtract(s),t?h=t:y={x:e.pageX-n.left-v.x,y:e.pageY-n.top-v.y}},!0),a.addEventListener("mousemove",function(e){if(h){var t=a.getBoundingClientRect(),n={x:e.clientX-t.left,y:e.clientY-t.top},o=(new i).load(g);m=new i(n.x,n.y).subtract(o)}else if(y){var t=a.getBoundingClientRect(),n={x:e.clientX-t.left,y:e.clientY-t.top};g={x:n.x-y.x,y:n.y-y.y},c.setTransform(1,0,0,1,g.x,g.y)}},!0),a.addEventListener("mouseup",function(e){if(h)d.postMessage(["nomove",{selectedNode:h}]),h=void 0;else if(y){var t=a.getBoundingClientRect();v={x:e.pageX-t.left-y.x,y:e.pageY-t.top-y.y},y=void 0}},!0);var _=new Array(100);_.fill(r.simulationSpeed),requestAnimationFrame(s),d.postMessage("run")})}),require.alias("preact/dist/preact.js","preact"),require.register("___globals___",function(e,t,n){})}(),require("___globals___");