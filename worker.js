!function(){"use strict";var t="undefined"==typeof global?self:global;if("function"!=typeof t.require){var e={},n={},i={},o={}.hasOwnProperty,r=/^\.\.?(\/|$)/,s=function(t,e){for(var n,i=[],o=(r.test(e)?t+"/"+e:e).split("/"),s=0,a=o.length;s<a;s++)n=o[s],".."===n?i.pop():"."!==n&&""!==n&&i.push(n);return i.join("/")},a=function(t){return t.split("/").slice(0,-1).join("/")},c=function(e){return function(n){var i=s(a(e),n);return t.require(i,e)}},u=function(t,e){var i=p&&p.createHot(t),o={id:t,exports:{},hot:i};return n[t]=o,e(o.exports,c(t),o),o.exports},h=function(t){return i[t]?h(i[t]):t},d=function(t,e){return h(s(a(t),e))},f=function(t,i){null==i&&(i="/");var r=h(t);if(o.call(n,r))return n[r].exports;if(o.call(e,r))return u(r,e[r]);throw new Error("Cannot find module '"+t+"' from '"+i+"'")};f.alias=function(t,e){i[e]=t};var l=/\.[^.\/]+$/,y=/\/index(\.[^\/]+)?$/,x=function(t){if(l.test(t)){var e=t.replace(l,"");o.call(i,e)&&i[e].replace(l,"")!==e+"/index"||(i[e]=t)}if(y.test(t)){var n=t.replace(y,"");o.call(i,n)||(i[n]=t)}};f.register=f.define=function(t,i){if(t&&"object"==typeof t)for(var r in t)o.call(t,r)&&f.register(r,t[r]);else e[t]=i,delete n[t],x(t)},f.list=function(){var t=[];for(var n in e)o.call(e,n)&&t.push(n);return t};var p=t._hmr&&new t._hmr(d,f,e,n);f._cache=n,f.hmr=p&&p.wrap,f.brunch=!0,t.require=f}}(),function(){function t(){var t=200,e=50;h.push(new c(t,e,0,0,0,0,(!0),[1]));for(var n=1;n<s.numOfNodes;n++){t+=s.nominalStringLength;var i=[n-1];n<s.numOfNodes-1&&i.push(n+1),h.push(new c(t,e,0,0,0,0,(!1),i))}var o=r.getNode(h.length-1,h);o.fixed=!0,o.position.x=260,o.position.y=300;var a=new c(220,50,0,0,0,0,(!0),[1]);h.push(a);var u=r.getNode(1,h);u.connectedNodes.push(a.id)}function e(){var t=h;h.forEach(function(e){e.connectedNodes.forEach(function(n){var i=r.getNode(n,h);i.connectedNodes.indexOf(e.id)<0&&(t=t.map(function(t){return t.id===n&&t.connectedNodes.push(e.id),t}))})}),h=t}function n(){d=self.performance.now(),setTimeout(o,0)}function i(t){var e=0,n=0,i=0,o=0;t.connectedNodes.forEach(function(a){var c=r.getNode(a,h);if(c){var u=r.getLength(c,t);if(u>s.nominalStringLength){var d=u-s.nominalStringLength,f=r.getAngleFromHorizontal(t,c);e+=Math.sin(f)*d*s.springConstant,n+=Math.cos(f)*d*s.springConstant}i+=s.internalViscousFrictionConstant*(t.velocity.x-c.velocity.x),o+=s.internalViscousFrictionConstant*(t.velocity.y-c.velocity.y)}});var c=9.8*s.ropeWeightPerNode,u=0*s.ropeWeightPerNode,d=t.velocity.y*s.viscousConstant,f=t.velocity.x*s.viscousConstant;return t.force.y=c+e-d-o,t.force.x=u+n-f-i,new a(t.force.x/s.ropeWeightPerNode,t.force.y/s.ropeWeightPerNode)}function o(){for(var t=0,e=0,n=0;n<100;n++){var r=self.performance.now(),a=r-d,c=a/1e3,l=a*s.simulationSpeed;l>s.maxStep?(elapsedTime=s.maxStep/1e3,console.warn("Max step exceeded, simulation speed may not be correct.")):elapsedTime=l/1e3;var y=elapsedTime/c;isNaN(y)||(t+=1,e+=y),d=r;for(var x=0;x<h.length;x++){var p=h[x];p.fixed||(p.velocity.x=p.velocity.x+p.force.x/s.ropeWeightPerNode*elapsedTime/2,p.velocity.y=p.velocity.y+p.force.y/s.ropeWeightPerNode*elapsedTime/2,p.position.y=p.position.y+p.velocity.y*elapsedTime,p.position.x=p.position.x+p.velocity.x*elapsedTime,dv=i(p).multiply(elapsedTime/2),p.velocity.x=p.velocity.x+dv.x,p.velocity.y=p.velocity.y+dv.y)}}f=e/t,u&&setTimeout(o,0)}"undefined"==typeof window?this:window;require.register("js/shared/config.js",function(t,e,n){"use strict";var i=10,o=40,r=10,s=25,a=8,c=2e-5,u=4,h=50,d=150,f=0,l=1,y=r/i*l;n.exports={metre:i,numOfNodes:o,nominalStringLength:r,springConstant:s,internalViscousFrictionConstant:a,viscousConstant:c,simulationSpeed:u,maxStep:h,dangerForceMax:d,dangerForceMin:f,ropeWeightPerMetre:l,ropeWeightPerNode:y}}),require.register("js/shared/constants.js",function(t,e,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ControlsEnum=Object.freeze({pan:"pan",grab:"grab",anchor:"anchor",erase:"erase",rope:"rope",pause:"pause"})}),require.register("js/shared/helper.js",function(t,e,n){"use strict";function i(t,e){return e.find(function(e){return e.id===t})}function o(t,e){var n=Math.abs(t.position.x-e.position.x),i=Math.abs(t.position.y-e.position.y);return Math.sqrt(n*n+i*i)}function r(t,e){return{x:(t.position.x+e.position.x)/2,y:(t.position.y+e.position.y)/2}}function s(t,e){return Math.atan2(e.position.y-t.position.y,e.position.x-t.position.x)}function a(t,e){var n=o(t,e),i=n-c.nominalStringLength,r=s(t,e),a=Math.sin(r)*i*c.springConstant,u=Math.cos(r)*i*c.springConstant,h=Math.sqrt(a*a+(u+u));return{total:h,x:u,y:a}}var c=e("js/shared/config");n.exports={getAngleFromHorizontal:s,getForce:a,getLength:o,getMidpoint:r,getNode:i}}),require.register("js/shared/node.js",function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(){return a+=1}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=e("js/shared/vector").Vector,a=-1,c=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,h=arguments.length>6&&void 0!==arguments[6]&&arguments[6],d=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[],f=arguments[8];i(this,t),this.id=f?f:o(),this.position=new s(e,n),this.velocity=new s(r,a),this.force=new s(c,u),this.fixed=h,this.connectedNodes=d}return r(t,[{key:"getObject",value:function(){return{id:this.id,position:this.position,velocity:this.velocity,force:this.force,fixed:this.fixed,connectedNodes:this.connectedNodes}}},{key:"loadObject",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.id=t.id?t.id:this.id,this.position=t.position||this.position,this.velocity=t.velocity||this.velocity,this.force=t.force||this.force,this.fixed=t.fixed||this.fixed,this.connectedNodes=t.connectedNodes||this.connectedNodes}},{key:"copyNode",value:function(){return new t(this.position.x,this.position.y,this.velocity.x,this.velocity.y,this.force.x,this.force.y,this.fixed,this.connectedNodes,this.id)}}]),t}();n.exports={Node:c}}),require.register("js/shared/vector.js",function(t,e,n){"use strict";function i(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}i.prototype={load:function(t){return new i(t.x||0,t.y||0,t.z||0)},negative:function(){return new i((-this.x),(-this.y),(-this.z))},add:function(t){return t instanceof i?new i(this.x+t.x,this.y+t.y,this.z+t.z):new i(this.x+t,this.y+t,this.z+t)},subtract:function(t){return t instanceof i?new i(this.x-t.x,this.y-t.y,this.z-t.z):new i(this.x-t,this.y-t,this.z-t)},multiply:function(t){return t instanceof i?new i(this.x*t.x,this.y*t.y,this.z*t.z):new i(this.x*t,this.y*t,this.z*t)},divide:function(t){return t instanceof i?new i(this.x/t.x,this.y/t.y,this.z/t.z):new i(this.x/t,this.y/t,this.z/t)},equals:function(t){return this.x==t.x&&this.y==t.y&&this.z==t.z},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},cross:function(t){return new i(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)},length:function(){return Math.sqrt(this.dot(this))},unit:function(){return this.divide(this.length())},min:function(){return Math.min(Math.min(this.x,this.y),this.z)},max:function(){return Math.max(Math.max(this.x,this.y),this.z)},toAngles:function(){return{theta:Math.atan2(this.z,this.x),phi:Math.asin(this.y/this.length())}},angleTo:function(t){return Math.acos(this.dot(t)/(this.length()*t.length()))},toArray:function(t){return[this.x,this.y,this.z].slice(0,t||3)},clone:function(){return new i(this.x,this.y,this.z)},init:function(t,e,n){return this.x=t,this.y=e,this.z=n,this}},i.negative=function(t,e){return e.x=-t.x,e.y=-t.y,e.z=-t.z,e},i.add=function(t,e,n){return n=n?n:new i,e instanceof i?(n.x=t.x+e.x,n.y=t.y+e.y,n.z=t.z+e.z):(n.x=t.x+e,n.y=t.y+e,n.z=t.z+e),n},i.subtract=function(t,e,n){return n=n?n:new i,e instanceof i?(n.x=t.x-e.x,n.y=t.y-e.y,n.z=t.z-e.z):(n.x=t.x-e,n.y=t.y-e,n.z=t.z-e),n},i.multiply=function(t,e,n){return n=n?n:new i,e instanceof i?(n.x=t.x*e.x,n.y=t.y*e.y,n.z=t.z*e.z):(n.x=t.x*e,n.y=t.y*e,n.z=t.z*e),n},i.divide=function(t,e,n){return e instanceof i?(n.x=t.x/e.x,n.y=t.y/e.y,n.z=t.z/e.z):(n.x=t.x/e,n.y=t.y/e,n.z=t.z/e),n},i.cross=function(t,e,n){return n.x=t.y*e.z-t.z*e.y,n.y=t.z*e.x-t.x*e.z,n.z=t.x*e.y-t.y*e.x,n},i.unit=function(t,e){var n=t.length();return e.x=t.x/n,e.y=t.y/n,e.z=t.z/n,e},i.fromAngles=function(t,e){return new i(Math.cos(t)*Math.cos(e),Math.sin(e),Math.sin(t)*Math.cos(e))},i.randomDirection=function(){return i.fromAngles(Math.random()*Math.PI*2,Math.asin(2*Math.random()-1))},i.min=function(t,e){return new i(Math.min(t.x,e.x),Math.min(t.y,e.y),Math.min(t.z,e.z))},i.max=function(t,e){return new i(Math.max(t.x,e.x),Math.max(t.y,e.y),Math.max(t.z,e.z))},i.lerp=function(t,e,n){return e.subtract(t).multiply(n).add(t)},i.fromArray=function(t){return new i(t[0],t[1],t[2])},i.angleBetween=function(t,e){return t.angleTo(e)},n.exports={Vector:i}});var r=require("js/shared/helper"),s=require("js/shared/config"),a=require("js/shared/vector").Vector,c=require("js/shared/node").Node,u=!0,h=[],d=new Date,f=0;onmessage=function(i){if("init"===i.data)t();else if("run"===i.data)u=!0,n();else if("pause"===i.data)u=!1;else if("send"===i.data)postMessage({nodes:h,trueSimulationSpeed:f});else if("load"===i.data[0])h=JSON.parse(atob(i.data[1]));else if("move"===i.data[0]){var o=r.getNode(i.data[1].selectedNode.id,h);o.position=(new a).load(i.data[1].mousePosition),o.velocity=new a,o.force=new a}else if("nomove"===i.data[0]);else if("newanchor"===i.data[0]){var s=i.data[1].mousePosition;h.push(new c(s.x,s.y,0,0,0,0,(!0),[]))}else if("deletenode"===i.data[0]){var o=i.data[1].node;h=h.filter(function(t){return t.id!==o.id}).map(function(t){return t.connectedNodes=t.connectedNodes.filter(function(t){return t!==o.id}),t})}else if("addnodes"===i.data[0]){var d=i.data[1].nodes;h=h.concat(d),e()}},require.register("___globals___",function(t,e,n){})}(),require("___globals___");